# プロジェクト構造の詳細

## ファイル構成

### メインファイル

- **app.py**: Flaskアプリケーションのメインファイル
  - ルーティング定義
  - 物体検出APIエンドポイント (`/detect`)
  - 説明文生成APIエンドポイント (`/describe`)
  - 依存関係チェック機能

### 機能モジュール

- **yolo_detection.py**: YOLOv8物体検出機能
  - 画像の前処理（base64エンコード対応）
  - YOLOv8sモデルによる推論
  - 検出結果のJSON形式変換

- **local_description.py**: ローカル説明文生成（APIキー不要）
  - 物体検出のクラス名から説明文を生成
  - 80種類以上の物体に対応
  - 子供向けの分かりやすい説明文（漢字にひらがなが振られている）

- **gpt_detection.py**: GPT-4o-mini説明文生成（オプション）
  - OpenAI APIを使用した説明文生成
  - APIキーが必要
  - 現在は使用していない（ローカル説明文生成を使用）

### ユーティリティ

- **check_installation.py**: ライブラリインストール確認スクリプト
  - 必要なライブラリがインストールされているか確認
  - 不足しているライブラリを表示

### インストールスクリプト

- **install_with_fix.bat**: Windows用自動インストールスクリプト
  - 仮想環境の有効化
  - 必要なライブラリの自動インストール
  - エラーハンドリング付き

### 設定ファイル

- **requirements.txt**: プロジェクトの依存関係
  - flask
  - ultralytics
  - opencv-python-headless
  - numpy
  - openai (オプション)
  - python-dotenv (オプション)
  - Pillow

- **.gitignore**: Gitで無視するファイル
  - venv/
  - __pycache__/
  - .env
  - *.pt (モデルファイル)

### フロントエンド

- **templates/camera.html**: メインのHTMLテンプレート
  - カメラプレビュー
  - 物体検出結果の表示
  - 説明文パネル
  - JavaScriptによるリアルタイム処理

- **static/styles.css**: スタイルシート
  - カメラUIのスタイリング
  - 説明文パネルのスタイル

### その他

- **image/**: 画像ファイル用ディレクトリ
  - elephant.png (サンプル画像)

- **README.md**: プロジェクトの説明書

## データフロー

1. **カメラ映像の取得**
   - ブラウザのgetUserMedia APIでカメラ映像を取得
   - video要素に表示

2. **フレームキャプチャ**
   - 500msごとにフレームをキャプチャ
   - canvas要素でbase64エンコード

3. **物体検出**
   - `/detect`エンドポイントに画像を送信
   - YOLOv8sモデルで推論
   - 検出結果をJSON形式で返す

4. **検出結果の表示**
   - canvas要素にバウンディングボックスを描画
   - クラス名と信頼度を表示

5. **説明文の生成**
   - バウンディングボックスをクリック
   - `/describe`エンドポイントに検出情報を送信
   - ローカル説明文生成機能で説明文を生成
   - 画面に表示

## モデルファイル

- **yolov8s.pt**: YOLOv8sモデル（初回実行時に自動ダウンロード）
- **yolov8n.pt**: YOLOv8nモデル（使用していないが、過去のバージョンで使用していた）

## 注意事項

- モデルファイル（*.pt）は.gitignoreに含まれているため、Gitにコミットされません
- 初回実行時に自動的にダウンロードされます
- .envファイルはAPIキーを保存するために使用しますが、現在は使用していません（ローカル説明文生成を使用）




